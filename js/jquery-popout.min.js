if(typeof(Oryzone)=="undefined")
Oryzone={};Oryzone.Popout=function(el,options)
{if(el)
{this.init(el,options);}};(function($){if(!$.event.special["destroyed"])
{$.event.special["destroyed"]={remove:function(handleObj){if(handleObj.removed||handleObj.handler.removed)return;var event=$.Event("destroyed");event.preventDefault();event.stopPropagation();handleObj.removed=true;handleObj.handler.call(this,event)},setup:function(handleObj){}}
var oldClean=$.cleanData
$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){$.event.remove(elem,'destroyed');}
oldClean(elems)}}
Oryzone.PopoutAnimation={};Oryzone.PopoutAnimation.none=function()
{this.setElement=function(element)
{this.element=element;};this.setPosition=function(position)
{this.position=position;};this.setOptions=function(options)
{this.options=options;};this.beforeOpen=function(){};this.open=function(afterAnimation){this.element.css({left:this.position[0]+"px",top:this.position[1]+"px",display:this.options.displayOn});afterAnimation();};this.beforeClose=function(){};this.close=function(afterAnimation){this.element.css('display',this.options.displayOff);afterAnimation();};};Oryzone.PopoutAnimation.slide=function()
{return $.extend({},new Oryzone.PopoutAnimation.none(),{beforeOpen:function(){if("undefined"==typeof this.elementHeight)
{this.elementHeight=this.element.height();this.elementPaddingTop=this.element.css("paddingTop");this.elementPaddingBottom=this.element.css("paddingBottom");}},open:function(afterAnimation){this.element.css({left:this.position[0]+"px",top:this.position[1]+"px",display:this.options.displayOn,height:0,paddingTop:'0px',paddingBottom:'0px'});this.element.stop().animate({height:this.elementHeight,paddingTop:this.elementPaddingTop,paddingBottom:this.elementPaddingBottom},this.options.animationSpeed,this.options.animationEasing,afterAnimation);},beforeClose:function(){},close:function(afterAnimation){var self=this;this.element.stop().animate({height:0,paddingTop:'0px',paddingBottom:'0px'},this.options.animationSpeed,this.options.animationEasing,function(){self.element.css({'display':self.options.displayOff,'height':self.elementHeight,'paddingTop':self.elementPaddingTop,'paddingBottom':self.elementPaddingBottom});afterAnimation();});}});};Oryzone.PopoutAnimation.fade=function()
{return $.extend({},new Oryzone.PopoutAnimation.none(),{beforeOpen:function(){},open:function(afterAnimation){this.element.css({left:this.position[0]+"px",top:this.position[1]+"px"});this.element.fadeIn(this.options.animationSpeed,this.options.animationEasing,afterAnimation);},beforeClose:function(){},close:function(afterAnimation){var self=this;this.element.fadeOut(this.options.animationSpeed,this.options.animationEasing,function(){self.element.css('display',self.options.displayOff);afterAnimation();});}});};Oryzone.PopoutAnimation.expand=function()
{return $.extend({},new Oryzone.PopoutAnimation.none(),{beforeOpen:function(){if("undefined"==typeof this.elementHeight)
{this.elementHeight=this.element.height();this.elementWidth=this.element.width();this.elementPaddingTop=this.element.css("paddingTop");this.elementPaddingRight=this.element.css("paddingRight");this.elementPaddingBottom=this.element.css("paddingBottom");this.elementPaddingLeft=this.element.css("paddingLeft");}},open:function(afterAnimation){this.element.css({left:this.position[0]+"px",top:this.position[1]+"px",display:this.options.displayOn,height:0,width:0,paddingTop:'0px',paddingRight:'0px',paddingBottom:'0px',paddingLeft:'0px'});this.element.stop().animate({height:this.elementHeight,width:this.elementWidth,paddingTop:this.elementPaddingTop,paddingRight:this.elementPaddingRight,paddingBottom:this.elementPaddingBottom,paddingLeft:this.elementPaddingLeft},this.options.animationSpeed,this.options.animationEasing,afterAnimation);},beforeClose:function(){},close:function(afterAnimation){var self=this;this.element.stop().animate({height:0,width:0,paddingTop:'0px',paddingRight:'0px',paddingBottom:'0px',paddingLeft:'0px'},this.options.animationSpeed,this.options.animationEasing,function(){self.element.css({'display':self.options.displayOff,'height':self.elementHeight,'width':self.elementWidth,'paddingTop':self.elementPaddingTop,'paddingRight':self.elementPaddingRight,'paddingBottom':self.elementPaddingBottom,'paddingLeft':self.elementPaddingLeft});afterAnimation();});}});}
var defaults={'button':'.popout-button','content':'.popout-content','closeButton':'.popout-close','openClass':'popout-open','openOnHover':false,'openOnClick':true,'closeOnHoverOut':true,'closeOnClickOut':false,'closeDelay':500,'useCloseButton':true,'z-index':9999,'contentPosition':'absolute','displayOn':'block','displayOff':'none','position':'data','anchor':'data','distance':'data','defaultPosition':'SW','defaultAnchor':'NW','defaultDistance':0,'animation':'none','animationSpeed':'fast','animationEasing':'swing'};var geo2dir={'NW':['left','top'],'N':['center','top'],'NE':['right','top'],'W':['left','center'],'C':['center','center'],'E':['right','center'],'SW':['left','bottom'],'S':['center','bottom'],'SE':['right','bottom']};var cTabPosition={'left':{'top':{'x':"+0",'y':"+0"},'center':{'x':"+0",'y':"+ch/2"},'bottom':{'x':"+0",'y':"+ch"}},'center':{'top':{'x':"+cw/2",'y':"+0"},'center':{'x':"+cw/2",'y':"+ch/2"},'bottom':{'x':"+cw/2",'y':"+ch"}},'right':{'top':{'x':"+cw",'y':"+0"},'center':{'x':"+cw",'y':"+ch/2"},'bottom':{'x':"+cw",'y':"+ch"}}};var cTabAnchor={'left':{'top':{'x':"+0",'y':"+0"},'center':{'x':"+0",'y':"-ph/2"},'bottom':{'x':"+0",'y':"-ph"}},'center':{'top':{'x':"-pw/2",'y':"+0"},'center':{'x':"-pw/2",'y':"-ph/2"},'bottom':{'x':"-pw/2",'y':"-ph"}},'right':{'top':{'x':"-pw",'y':"+0"},'center':{'x':"-pw",'y':"-ph/2"},'bottom':{'x':"-pw",'y':"-ph"}}};var cTabDistance={'left':{'top':{'x':"-dx",'y':"-dy"},'center':{'x':"-dx",'y':"+0"},'bottom':{'x':"-dx",'y':"+dy"}},'center':{'top':{'x':"+0",'y':"-dy"},'center':{'x':"+0",'y':"+0"},'bottom':{'x':"+0",'y':"+dy"}},'right':{'top':{'x':"+dx",'y':"-dy"},'center':{'x':"+dx",'y':"+0"},'bottom':{'x':"+dx",'y':"+dy"}}};var normalizeAnimation=function(animation)
{if('string'==typeof animation)
{switch(animation.toLowerCase())
{case"none":return new Oryzone.PopoutAnimation.none();break;case"slide":return new Oryzone.PopoutAnimation.slide();break;case"fade":return new Oryzone.PopoutAnimation.fade();break;case"expand":return new Oryzone.PopoutAnimation.expand();break;default:throw"InvalidArgumentException: '"+animation+"' is not a valid animation";}}
if(!(animation.beforeOpen&&"function"==typeof animation.beforeOpen&&animation.open&&"function"==typeof animation.open&&animation.beforeClose&&"function"==typeof animation.beforeClose&&animation.close&&"function"==typeof animation.close&&animation.setPosition&&"function"==typeof animation.setPosition&&animation.setElement&&"function"==typeof animation.setElement&&animation.setOptions&&"function"==typeof animation.setOptions))
throw"InvalidArgumentException: The given animation object is not a valid animation";return animation;};var normalizeRef=function(ref)
{if('string'==typeof ref)
{ref=ref.toUpperCase();if(geo2dir[ref]!=null)
return geo2dir[ref];}
else if(ref instanceof Array&&ref.length==2)
{ref[0]=ref[0].toLowerCase();ref[1]=ref[1].toLowerCase();if((ref[0]=='left'||ref[0]=='center'||ref[0]=='right')&&(ref[1]=='top'||ref[1]=='center'||ref[1]=='bottom'))
{return ref;}}
throw"InvalidArgumentException: '"+ref+"' is not a valid reference";};var normalizeDistance=function(distance)
{if("number"==typeof distance||("string"==typeof distance&&parseInt(distance)!=NaN))
{return[parseInt(distance),parseInt(distance)];}
else if(distance instanceof Array&&distance.length==2)
{if("number"==typeof parseInt(distance[0])&&"number"==typeof parseInt(distance[1]))
return[parseInt(distance[0]),parseInt(distance[1])];}
throw"InvalidArgumentException: '"+distance+"' is not a valid distance";}
var calculateFinalPosition=function(cw,ch,pw,ph,dx,dy,pos_x,pos_y,anch_x,anch_y)
{return[eval(cTabPosition[pos_x][pos_y]['x']+
cTabAnchor[anch_x][anch_y]['x']+
cTabDistance[pos_x][pos_y]['x']),eval(cTabPosition[pos_x][pos_y]['y']+
cTabAnchor[anch_x][anch_y]['y']+
cTabDistance[pos_x][pos_y]['y'])];};var getInstance=function(el)
{el=$(el);return el.data('oryzone_popout');}
$.fn.popout=function(options)
{var args=$.makeArray(arguments),after=args.slice(1);return this.each(function()
{if((instance=getInstance(this)))
{if(typeof options=="string")
{instance[options].apply(instance,after);}
else
{instance.update(options);}}
else
{new Oryzone.Popout($(this),options);}});};$.fn.popoutInstance=function()
{return getInstance(this);}
var raiseEvent=function(eventName,$this)
{$this.container.trigger("Oryzone_popout_"+eventName,[$this.container,$this]);};var createGlassPane=function()
{this.glassPane=$('<div class="popout-glassPane"/>').css({position:"absolute","z-index":this.options['z-index']-1,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0}).click(function(){this.close();}).appendTo($('body'));};var destroyGlassPane=function()
{if(this.glassPane)
{this.glassPane.remove();this.glassPane=undefined;}};var onButtonClick=function(event)
{event.preventDefault();this.toggle();};var onCloseButtonClick=function(event)
{event.preventDefault();this.close();};var onMouseOver=function(event)
{if(this.options.openOnHover&&!this.isOpen())
this.open();if(this.isOpen()&&this.options.closeOnHoverOut)
this.cancelDelayedClose();};var onMouseOut=function(event)
{if(this.isOpen()&&this.options.closeOnHoverOut)
this.delayedClose();};$.extend(Oryzone.Popout.prototype,{name:"oryzone_popout",version:1.0,init:function(el,options)
{this._private={timeout:null,defaults:{container:{},content:{}}};el.data(this.name,this);this.options=$.extend({},defaults,options);this.container=el;this._private.defaults.container.position=this.container.css("position");this.container.css("position","relative");this.content=this.container.find(this.options.content);this._private.defaults.content={position:this.content.css("position"),"z-index":this.content.css("z-index"),top:this.content.css("top"),left:this.content.css("left"),display:this.content.css("display")};this.content.css({"position":this.options.contentPosition,"z-index":this.options['z-index'],"top":0});if(this.content.size()==0)
throw"CannotFindContentException: the selector '"+this.options.content+"' was not able to find any element";this.button=this.container.find(this.options.button);this.closeButton=this.container.find(this.options.closeButton);var data=this.container.data("popout");if(!data)
{data={distance:this.container.data().popoutDistance,position:this.container.data().popoutPosition,anchor:this.container.data().popoutAnchor};}
if(this.options.distance=="data")
this.options.distance=(data&&data.distance)?data.distance:this.options.defaultDistance;if(this.options.anchor=="data")
this.options.anchor=(data&&data.anchor)?data.anchor:this.options.defaultAnchor;if(this.options.position=="data")
this.options.position=(data&&data.position)?data.position:this.options.defaultPosition;this.options.distance=normalizeDistance(this.options.distance);this.options.anchor=normalizeRef(this.options.anchor);this.options.position=normalizeRef(this.options.position);this.options.animation=normalizeAnimation(this.options.animation);this.bind();},bind:function()
{this.onButtonClick=$.proxy(onButtonClick,this);this.onCloseButtonClick=$.proxy(onCloseButtonClick,this);this.onMouseOver=$.proxy(onMouseOver,this);this.onMouseOut=$.proxy(onMouseOut,this);this.container.bind("destroyed",$.proxy(this.teardown,this));this.button.bind("click",this.onButtonClick);if(this.options.useCloseButton&&this.closeButton.size()>0)
{if(this.options.openOnClick)
{this.closeButton.bind("click",this.onCloseButtonClick);}}
this.container.bind("mouseover",this.onMouseOver);this.container.bind("mouseout",this.onMouseOut);},unbind:function()
{this.button.unbind("click",this.onButtonClick);this.closeButton.unbind("click",this.onCloseButtonClick);this.container.unbind("mouseover",this.onMouseOver);this.container.unbind("mouseout",this.onMouseOut);this.container.unbind("destroyed",this.teardown);},update:function(options)
{this.destroy();this.init(this.container,options);},destroy:function()
{this.teardown();},teardown:function()
{raiseEvent("destroying",this);this.container.removeData(this.name);this.container.css(this._private.defaults.container);this.content.css(this._private.defaults.content);this.content.removeClass(this.options.openClass);this.unbind();this.button=undefined;this.closeButton=undefined;this.content=undefined;raiseEvent("destroyed",this);},isOpen:function()
{return this.content.hasClass(this.options.openClass);},open:function()
{var self=this;pos=calculateFinalPosition(this.button.outerWidth(),this.button.outerHeight(),this.content.outerWidth(),this.content.outerHeight(),this.options.distance[0],this.options.distance[1],this.options.position[0],this.options.position[1],this.options.anchor[0],this.options.anchor[1]);this.options.animation.setPosition(pos);this.options.animation.setElement(this.content);this.options.animation.setOptions(this.options);this.options.animation.beforeOpen();raiseEvent("opening",this);if(this.options.closeOnClickOut)
$.proxy(createGlassPane,this)();this.content.addClass(this.options.openClass);this.content.addClass(this.options.openClass);this.options.animation.open(function(){raiseEvent("opened",self);});return this;},close:function()
{var self=this;this.options.animation.beforeClose();raiseEvent("closing",this);$.proxy(destroyGlassPane,this)();this.cancelDelayedClose();this.content.removeClass(this.options.openClass);this.options.animation.close(function(){raiseEvent("closed",self);})
return this;},toggle:function()
{if(this.isOpen())
this.close();else
this.open();return this;},delayedClose:function(delay)
{if(delay)
{if("number"!=typeof delay)
throw"InvalidArgumentException: '"+delay+"' is not a valid delay";}
else
{delay=this.options.closeDelay;}
this.cancelDelayedClose();var self=this;this._private.timeout=setTimeout(function(){self.close()},delay);return this;},cancelDelayedClose:function()
{if(this._private.timeout)
clearTimeout(this._private.timeout);return this;}});})(jQuery);